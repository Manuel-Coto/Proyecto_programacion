<!DOCTYPE html>
<html lang="es"
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="jakarta.faces.html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="jakarta.faces.core">
<h:head>
    <meta charset="UTF-8"/>
    <title>#{productoFrm.nombreBean}</title>
    <h:outputStylesheet library="estilos" name="disenoAlmacen.css"/>
    <h:outputStylesheet library="primefaces" name="primeicons/primeicons.css"/>
</h:head>
<h:body>


    <h1>#{productoFrm.nombreBean}</h1>

    <!-- LISTA PRINCIPAL -->
    <h:panelGroup id="pnlTabla">
        <h:form id="frmTop">
            <p:dataTable id="tablaProductos"
                         rendered="#{productoFrm.modoLista}"
                         value="#{productoFrm.modelo}" var="n" lazy="true"
                         paginator="true" rows="#{productoFrm.pageSize}"
                         paginatorPosition="bottom"
                         selectionMode="single" selection="#{productoFrm.registro}"
                         rowKey="#{n.id}">
                <p:ajax event="rowSelect" listener="#{productoFrm.selectionHandler}"
                        update=":pnlTabla :pnlDetalle :frmTop:messages"/>
                <p:column headerText="ID" style="width:340px"><h:outputText value="#{n.id}" /></p:column>
                <p:column headerText="Nombre"><h:outputText value="#{n.nombreProducto}" /></p:column>
                    <h:outputText value="#{n.activo ? 'Sí' : 'No'}" />
                </p:column>
            </p:dataTable>

            <p:commandButton id="btnNuevo" value="Nuevo Producto" styleClass="btn-rojo"
                             rendered="#{productoFrm.modoLista}"
                             actionListener="#{productoFrm.btnNuevoHandler}"
                             process="@this" immediate="true"
                             update=":pnlDetalle :pnlTabla :frmTop:messages"/>

                             rendered="#{productoFrm.modoDetalle}"
                             actionListener="#{productoFrm.btnCancelarHandler}"
                             process="@this" immediate="true"
                             update=":pnlDetalle :pnlTabla :frmTop:messages"/>

            <p:growl id="messages" showDetail="true" life="5000" />
        </h:form>
    </h:panelGroup>

    <!-- DETALLE -->
    <h:panelGroup id="pnlDetalle">
                    <p:panelGrid columns="2" styleClass="form-grid-2col" columnClasses="col-label,col-field">

                        <h:outputLabel for="txtIdPanel" value="ID:"/>
                        <h:panelGroup id="txtIdPanel">
                            <h:outputText rendered="#{empty productoFrm.registro.id}"
                                          value="(Se asignará automáticamente al guardar)"/>
                                         rendered="#{not empty productoFrm.registro.id}" readonly="true"/>
                        </h:panelGroup>

                        <h:outputLabel for="txtNombre" value="Nombre:"/>
                        <h:inputText id="txtNombre" value="#{productoFrm.registro.nombreProducto}" styleClass="inp"/>


                        <h:outputLabel for="txtRef" value="Referencia externa:"/>
                        <h:inputTextarea id="txtRef" value="#{productoFrm.registro.referenciaExterna}" rows="2" styleClass="inp"/>

                        <h:outputLabel for="txtComentarios" value="Comentarios:"/>
                        <h:inputTextarea id="txtComentarios" value="#{productoFrm.registro.comentarios}" rows="3" styleClass="inp"/>
                    </p:panelGrid>

                    <p:panelGrid columns="3" style="margin-top: 15px;">
                        <p:commandButton value="Crear Producto" styleClass="btn-rojo"
                                         actionListener="#{productoFrm.btnGuardarHandler}"
                                         rendered="#{productoFrm.estado.name() eq 'CREAR'}"
                                         update=":frmTop:messages :pnlDetalle :pnlTabla" process="@form"/>
                        <p:commandButton value="Modificar Producto" styleClass="btn-oscuro"
                                         actionListener="#{productoFrm.btnModificarHandler}"
                                         rendered="#{productoFrm.estado.name() eq 'MODIFICAR'}"
                                         update=":frmTop:messages :pnlDetalle :pnlTabla" process="@form"/>
                        <p:commandButton value="Eliminar Producto" styleClass="btn-rojo"
                                         actionListener="#{productoFrm.btnEliminarHandler}"
                                         rendered="#{productoFrm.estado.name() eq 'MODIFICAR'}"
                                         update=":frmTop:messages :pnlDetalle :pnlTabla"/>
                    </p:panelGrid>
                </p:tab>

                                     paginator="true" rows="#{productoTipoProductoFrm.pageSize}"
                                     paginatorPosition="bottom"
                                     selectionMode="single"
                                     selection="#{productoTipoProductoFrm.registro}"
                        </p:dataTable>



                                <h:outputText rendered="#{empty productoTipoProductoFrm.registro.id}"
                                              value="(Se asignará automáticamente al guardar)"/>
                            </h:panelGroup>
                            <h:panelGroup>
                                                 process="@this"
                                                 style="margin-left:8px"/>
                            </h:panelGroup>



                                                 actionListener="#{productoTipoProductoFrm.btnGuardarHandler}"
                                                 actionListener="#{productoTipoProductoFrm.btnModificarHandler}"
                                                 rendered="#{productoTipoProductoFrm.estado.name() eq 'MODIFICAR'}"
                                                 actionListener="#{productoTipoProductoFrm.btnEliminarHandler}"

                </p:tab>
            </p:tabView>
        </h:form>
    </h:panelGroup>

            <p:panelGrid columns="3" styleClass="form-grid-2col" columnClasses="col-label,col-field,col-field">
                <p:commandButton value="Buscar" styleClass="btn-oscuro"
            </p:panelGrid>

                         emptyMessage="Sin resultados">
                    <p:commandButton value="Elegir" styleClass="btn-rojo"
                </p:column>
            </p:dataTable>
        </h:form>
    </p:dialog>

</h:body>
</html>
